asyncapi: 2.1.0
x-ballerina-event-identifier:
  type : "body"
  path : "MessageStatus"
info:
  title: Twilio Events API
  version: 1.0.0
  description: TwiML events for programmable voice and message.
  termsOfService: 'https://www.twilio.com/legal/tos'
  contact:
    name: Twilio Contact Center
    url: 'https://www.twilio.com/learn/contact-center'
externalDocs:
  description: Twilio All API Reference Documentation
  url: 'https://www.twilio.com/docs/all'
components:
  schemas: 
    CallStatusEventWrapper:
      additionalProperties: true 
      externalDocs:
          description: Twilio's voice service commom request parameters.
          url: 'https://www.twilio.com/docs/voice/twiml#request-parameters'
      properties:
        AccountSid:
          type: string
          description: Your Twilio account ID. It is 34 characters long, and always starts with the letters AC.
        ApiVersion:
          type: string
          description: The version of the Twilio API used to handle this call.
        CallSid:
          type: string
          description: A unique identifier for this call, generated by Twilio.
        CallStatus:
          type: string
          description:  A descriptive status for the call.
        CallToken:
          type: string
          description: A token string needed to invoke a forwarded call.
        Called:
          type: string
          description: Called number. 
        CalledCity:
          type: string
          description: The city that called.
        CalledCountry:
          type: string
          description: The country that called.
        CalledState:
          type: string
          description: The state that called.
        CalledZip: 
          type: string
          description: The zip code that called.
        Caller:
          type: string
          description: The number of the caller.
        CallerCity:
          type: string
          description: The city of the caller.
        CallerCountry:
          type: string
          description: The country of the caller.
        CallerState:
          type: string
          description: The state of the caller.
        CallerZip:
          type: string
          description: he zip code of the caller.
        Direction:
          type: string
          description: A string describing the direction of the call.
        From:
          type: string
          description: The phone number or client identifier of the party that initiated the call.
        FromCity:
          type: string
          description: The city of the caller.
        FromCountry:
          type: string
          description: The country of the caller.
        FromState:
          type: string
          description: The state or province of the caller.
        FromZip:
          type: string
          description: The postal code of the caller.
        StirPassportToken:
          type: string
          description: The identity token which contains the information needs for authentication and verification of calls.
        StirVerstat:
          type: string
          description: The value that verify the authentiticy of a caler ID on an incomming call.
        To:
          type: string
          description: The phone number or client identifier of the called party.
        ToCity:
          type: string
          description: The city of the called party.
        ToCountry:
          type: string
          description: The country of the called party.
        ToState:
          type: string
          description: The postal code of the called party.
        ToZip:
          type: string 
          description: The postal code of the called party.
        RecordingSid:
          type: string
          description: The unique id of the Recording from this call.
        RecordingUrl:
          type: string
          description: The URL of the phone call's recorded audio.
        CallDuration:
          type: string
          description: The duration in seconds of the just-completed call.
        RecordingDuration:
          type: string
          description: The duration of the recorded audio (in seconds).
    SmsStatusChangeEventWrapper:
      additionalProperties: true
      externalDocs:
        description: Twilio's message service commom request parameters.
        url: 'https://www.twilio.com/docs/messaging/guides/webhook-request#request-parameters'
      properties:
        MessageSid:
          type: string
          description: A 34 character unique identifier for the message.
        SmsSid:
          type: string
          description: Same value as MessageSid. Deprecated and included for backward compatibility.
        AccountSid:
          type: string
          description: The 34 character id of the Account this message is associated with.
        MessagingServiceSid:
          type: string
          description: The 34 character id of the Messaging Service associated with the message.
        From:
          type: string
          description: The phone number or Channel address that sent this message.
        To:
          type: string
          description: The phone number or Channel address of the recipient.
        Body:
          type: string
          description: The text body of the message. Up to 1600 characters long.
        NumMedia:
          type: string
          description: The number of media items associated with your message.
        ReferralNumMedia:
          type: string
          description: The number of media items associated with a "Click to WhatsApp" advertisement.
        FromCity:
          type: string
          description: The city of the sender.
        FromState:
          type: string
          description: The state or province of the sender.
        SmsStatus:
          type: string
          description: The status of the message.
        FromZip:
          type: string
          description: The postal code of the called sender.
        FromCountry:
          type: string
          description: The country of the called sender.
        ToCity:
          type: string
          description: The city of the recipient.
        ToState:
          type: string
          description: The state or province of the recipient.
        ToZip:
          type: string
          description: The postal code of the recipient.
        ToCountry:
          type: string
          description: The country of the recipient.
        MessageStatus:
          type: string
          description: The status of the message.
        SmsMessageSid:
          type: string
          description: A unique identifier for this message, generated by Twilio.
        NumSegments:
          type: string
          description: Number of SMS messages it took to deliver the body of the message.
        ApiVersion:
          type: string
          description: The version of the Twilio API used to handle this message.
channels:
  callStatus:
    subscribe:
      message:
        oneOf:
          - x-ballerina-event-type: "queued"
            payload:
              $ref: '#/components/schemas/CallStatusEventWrapper'
          - x-ballerina-event-type: "ringing"
            payload:
              $ref: '#/components/schemas/CallStatusEventWrapper'
          - x-ballerina-event-type: "in-progress"
            payload:
              $ref: '#/components/schemas/CallStatusEventWrapper'
          - x-ballerina-event-type: "completed"
            payload:
              $ref: '#/components/schemas/CallStatusEventWrapper'
          - x-ballerina-event-type: "busy"
            payload:
              $ref: '#/components/schemas/CallStatusEventWrapper'
          - x-ballerina-event-type: "failed"
            payload:
              $ref: '#/components/schemas/CallStatusEventWrapper'
          - x-ballerina-event-type: "no-answer"
            payload:
              $ref: '#/components/schemas/CallStatusEventWrapper'
          - x-ballerina-event-type: "canceled"
            payload:
              $ref: '#/components/schemas/CallStatusEventWrapper' 
  smsStatus:
    subscribe:
      message:
        oneOf:
          - x-ballerina-event-type: "accepted"
            payload:
              $ref: '#/components/schemas/SmsStatusChangeEventWrapper'
          - x-ballerina-event-type: "queued"
            payload:
              $ref: '#/components/schemas/SmsStatusChangeEventWrapper'
          - x-ballerina-event-type: "sending"
            payload:
              $ref: '#/components/schemas/SmsStatusChangeEventWrapper'
          - x-ballerina-event-type: "sent"
            payload:
              $ref: '#/components/schemas/SmsStatusChangeEventWrapper'
          - x-ballerina-event-type: "failed"
            payload:
              $ref: '#/components/schemas/SmsStatusChangeEventWrapper'
          - x-ballerina-event-type: "delivered"
            payload:
              $ref: '#/components/schemas/SmsStatusChangeEventWrapper'
          - x-ballerina-event-type: "undelivered"
            payload:
              $ref: '#/components/schemas/SmsStatusChangeEventWrapper'
          - x-ballerina-event-type: "receiving"
            payload:
              $ref: '#/components/schemas/SmsStatusChangeEventWrapper'
          - x-ballerina-event-type: "received"
            payload:
              $ref: '#/components/schemas/SmsStatusChangeEventWrapper'
